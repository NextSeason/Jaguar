!function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!self.requestAnimationFrame;++c)self.requestAnimationFrame=self[b[c]+"RequestAnimationFrame"],self.cancelAnimationFrame=self[b[c]+"CancelAnimationFrame"]||self[b[c]+"CancelRequestAnimationFrame"];void 0===self.requestAnimationFrame&&void 0!==self.setTimeout&&(self.requestAnimationFrame=function(b){var c=Date.now(),d=Math.max(0,16-(c-a)),e=self.setTimeout(function(){b(c+d)},d);return a=c+d,e}),void 0===self.cancelAnimationFrame&&void 0!==self.clearTimeout&&(self.cancelAnimationFrame=function(a){self.clearTimeout(a)})}();var Jaguar={sides:[{url:"/JAGUAR/dist/static/images/1.jpg",position:[-512,0,0],rotation:[0,Math.PI/2,0]},{url:"/JAGUAR/dist/static/images/3.jpg",position:[512,0,0],rotation:[0,-Math.PI/2,0]},{url:"/JAGUAR/dist/static/images/5.jpg",position:[0,512,0],rotation:[Math.PI/2,0,0]},{url:"/JAGUAR/dist/static/images/6.jpg",position:[0,-512,0],rotation:[-Math.PI/2,0,0]},{url:"/JAGUAR/dist/static/images/4.jpg",position:[0,0,512],rotation:[0,Math.PI,0]},{url:"/JAGUAR/dist/static/images/2.jpg",position:[0,0,-512],rotation:[0,0,0]}],points:[{coords:[560,450],target:5,className:"red",link:"http://test.qctt.cn/JieBaoFirst/zhongkong.html"},{coords:[100,450],target:1,className:"blue",link:"http://test.qctt.cn/JieBaoFirst/waiguan.html"},{coords:[440,555],target:5,picture:9},{coords:[260,340],target:5,picture:1},{coords:[40,410],target:5,picture:2},{coords:[35,520],target:5,picture:3},{coords:[475,685],target:5,picture:4},{coords:[990,340],target:5,picture:5},{coords:[910,900],target:5,picture:6},{coords:[535,995],target:2,picture:7},{coords:[580,45],target:3,picture:8}],text:[{coords:[480,555],t:"点击中控台<br />启动按钮开启试驾体验",target:5},{coords:[135,455],t:"打开车门查看车身外观",className:"blue",target:1}],init:function(){var a=this;return this.action().render(),setTimeout(function(){a.setPoints(),a.setText(),a.bindEvent()},0),this.initPictures(),this},action:function(){return this.camera=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,1,1e3),this.controls=new THREE.DeviceOrientationControls(this.camera),this.controls.connect(),this.scene=new THREE.Scene,this},render:function(){for(var a=0,b=this.sides.length;b>a;a+=1)this.create(this.sides[a],a);return this.renderer=new THREE.CSS3DRenderer,this.renderer.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(this.renderer.domElement),this},create:function(a,b){var c,d=document.createElement("div");d.innerHTML='<img src="'+a.url+'" width="1026" />',d.className="sides side-"+b,d.style.width="1026px",d.style.height="1026px",c=new THREE.CSS3DObject(d),c.position.fromArray(a.position),c.rotation.fromArray(a.rotation),this.scene.add(c)},setPoints:function(){for(var a,b,c=0,d=this.points.length;d>c;c+=1)b=this.points[c],a=document.createElement("a"),a.className=["points","point-"+c,b.className||""].join(" "),b.hasOwnProperty("picture")?a.setAttribute("data-picture",b.picture):b.hasOwnProperty("link")&&a.setAttribute("href",b.link),a.innerHTML="<span><b></b></span>",a.style.left=b.coords[0]+"px",a.style.top=b.coords[1]+"px",$(".side-"+b.target).append(a);return this},setText:function(){for(var a,b,c=0,d=this.text.length;d>c;c+=1)b=this.text[c],a=document.createElement("a"),a.className=["text",b.className||""].join(" "),a.innerHTML=b.t,a.style.left=b.coords[0]+"px",a.style.top=b.coords[1]+"px",$(".side-"+b.target).append(a);return this},bindEvent:function(){var a=this;return $(document).on("touchstart",function(b){var c=/ip(?=od|ad|hone)/i.test(navigator.userAgent);if(c||a.picShowing)return!0;var d,e,f=document.getElementsByClassName("points"),g=0,h=f.length;for(touches=b.touches[0];h>g;g+=1)if(d=f[g],e=d.getBoundingClientRect(),Math.abs(touches.pageX-e.left)<40&&Math.abs(touches.pageY-e.top)<40)return void(null!==$(d).attr("data-picture")?(a.showPictures($(d).attr("data-picture")),b.preventDefault()):location.href=$(d).attr("href"))}),$(window).on("resize",function(b){a.camera.aspect=window.innerWidth/window.innerHeight,a.camera.updateProjectionMatrix(),a.renderer.setSize(window.innerWidth,window.innerHeight),a.initPictures()},!1),$(".points").on("touchstart",function(b){null!==$(this).attr("data-picture")&&(a.showPictures($(this).attr("data-picture")),b.preventDefault())}),$(".pictures a.back").on("tap",function(b){$(".pictures").addClass("hidden"),$(".pictures .items").removeClass("active"),a.picShowing=!1}),this},showPictures:function(a){$(".pictures .items").hide(),$(".pictures .item-"+a).show(),setTimeout(function(){$(".pictures .item-"+a).addClass("active")},100),$(".pictures").removeClass("hidden"),this.picShowing=!0},animate:function(){requestAnimationFrame(Jaguar.animate),Jaguar.controls.update(),Jaguar.renderer.render(Jaguar.scene,Jaguar.camera)},initPictures:function(){var a,b,c=window.innerWidth,d=window.innerHeight,e=640/1010,f=c/d;f>e?(b=Math.min(d,505),a=b*e,$(".pictures").css("height",b).css("width",a)):(a=Math.min(c,320),b=a/e,$(".pictures").css("width",a).css("height",b)),this.size={width:a,height:b},this.pos={top:(d-b)/2,left:(c-a)/2},$(".pictures").css("top",(d-b)/2).css("left",(c-a)/2)}}.init();Jaguar.animate(),$(function(){$(".nav-wrap").on("click",".main-nav",function(a){a.preventDefault();var b=$(this),c=b.closest(".nav-wrap"),d=c.find("nav a");if(!c.hasClass("active")){var e=c.width(),f=e/2,g=-90,h=-330,i=d.length,j=(h-g)/i;$.each(d,function(a,b){var c=(g+j*a)*(Math.PI/180),d=f+f*Math.cos(c),e=f+f*Math.sin(c);$(this).css({left:d+"px",top:e+"px"})})}c.toggleClass("active")})});